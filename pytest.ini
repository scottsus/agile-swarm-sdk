[pytest]
testpaths = tests
asyncio_mode = auto
addopts =
    -v
    --tb=short
    --strict-markers
    --ignore=tests/e2e/fixtures/

timeout = 300
timeout_method = thread

markers =
    smoke: Fast smoke tests (<30 seconds)
    feature: Medium feature tests (1-3 minutes)
    scenario: Slow scenario tests (5-15 minutes)
    e2e: All end-to-end tests
    expensive: Tests that use significant LLM tokens
    flaky: Tests that may fail due to LLM variance
    task(description): Task description for test run logger

filterwarnings =
    error
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

    # Suppress httpx resource warnings from pydantic-ai's cached clients.
    # Resources are properly cleaned up on process exit. This follows pydantic-ai's
    # own test configuration approach.
    ignore:unclosed <socket.socket:ResourceWarning
    ignore:unclosed transport <_SelectorSocketTransport:ResourceWarning
